# ä»€ä¹ˆæ—¶å€™ä¼šå‡ºç°åˆ—ä¸å¯¹é½ï¼Ÿ

## ğŸ¯ åˆ—ä¸å¯¹é½çš„å®šä¹‰

**åˆ—ä¸å¯¹é½** = ç°æœ‰æ•°æ®çš„åˆ—åæˆ–åˆ—é¡ºåºä¸æ–°æ•°æ®çš„åˆ—åæˆ–åˆ—é¡ºåºä¸ä¸€è‡´

## ğŸ“Š æ ‡å‡†åˆ—æ ¼å¼

**å½“å‰ä»£ç ä¸Šä¼ çš„åˆ—**ï¼ˆ`daily_collector_to_sheets.py` ç¬¬ 109 è¡Œï¼‰ï¼š
```python
upload_df = df[["Nested?","URL","Date","Outlet","Headline","Nut Graph"]].copy()
```

**æ ‡å‡†åˆ—é¡ºåº**ï¼š
1. Nested?
2. URL
3. Date
4. Outlet
5. Headline
6. Nut Graph

## âš ï¸ ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå‡ºç°åˆ—ä¸å¯¹é½ï¼Ÿ

### åœºæ™¯ 1: ä»£ç æ›´æ–°ï¼ˆæœ€å¸¸è§ï¼‰

**æƒ…å†µ**ï¼š
- ä¹‹å‰ä»£ç ä¸Šä¼ çš„åˆ—ï¼š`["URL","Date","Outlet","Headline"]`ï¼ˆ4 åˆ—ï¼‰
- ç°åœ¨ä»£ç ä¸Šä¼ çš„åˆ—ï¼š`["Nested?","URL","Date","Outlet","Headline","Nut Graph"]`ï¼ˆ6 åˆ—ï¼‰

**ç°æœ‰æ•°æ®ï¼ˆæ—§æ ¼å¼ï¼‰**ï¼š
```
| URL | Date | Outlet | Headline |
|-----|------|--------|----------|
| ... | ...  | ...    | ...      |
```

**æ–°æ•°æ®ï¼ˆæ–°æ ¼å¼ï¼‰**ï¼š
```
| Nested? | URL | Date | Outlet | Headline | Nut Graph |
|---------|-----|------|--------|----------|-----------|
| ...     | ... | ...  | ...    | ...      | ...       |
```

**ç»“æœ**ï¼šåˆ—åå’Œæ•°é‡ä¸åŒ¹é… â†’ éœ€è¦åˆ—å¯¹é½

### åœºæ™¯ 2: æ‰‹åŠ¨ä¿®æ”¹ Google Sheets

**æƒ…å†µ**ï¼š
- ç”¨æˆ·åœ¨ Google Sheets ä¸­æ‰‹åŠ¨æ·»åŠ äº†åˆ—ï¼ˆä¾‹å¦‚ "Category"ï¼‰
- æˆ–è€…åˆ é™¤äº†æŸäº›åˆ—
- æˆ–è€…é‡æ–°æ’åˆ—äº†åˆ—çš„é¡ºåº

**ç°æœ‰æ•°æ®ï¼ˆæ‰‹åŠ¨ä¿®æ”¹åï¼‰**ï¼š
```
| URL | Date | Outlet | Headline | Category | Nut Graph |
|-----|------|--------|----------|----------|-----------|
| ... | ...  | ...    | ...      | ...      | ...       |
```

**æ–°æ•°æ®ï¼ˆä»£ç æ ¼å¼ï¼‰**ï¼š
```
| Nested? | URL | Date | Outlet | Headline | Nut Graph |
|---------|-----|------|--------|----------|-----------|
| ...     | ... | ...  | ...    | ...      | ...       |
```

**ç»“æœ**ï¼š
- ç°æœ‰æ•°æ®å¤šäº† "Category" åˆ—
- ç°æœ‰æ•°æ®ç¼ºå°‘ "Nested?" åˆ—
- åˆ—é¡ºåºå¯èƒ½ä¸åŒ
- â†’ éœ€è¦åˆ—å¯¹é½

### åœºæ™¯ 3: ä¸åŒä»£ç è·¯å¾„å†™å…¥

**æƒ…å†µ**ï¼š
- æœ‰äº›æ•°æ®æ˜¯é€šè¿‡ `daily_collector_to_sheets.py` å†™å…¥çš„ï¼ˆ6 åˆ—ï¼‰
- æœ‰äº›æ•°æ®æ˜¯é€šè¿‡ `export_to_excel.py` ç„¶åæ‰‹åŠ¨å¯¼å…¥çš„ï¼ˆå¯èƒ½åˆ—ä¸åŒï¼‰
- æˆ–è€…é€šè¿‡ Streamlit UI å¯¼å‡ºçš„ï¼ˆå¯èƒ½åˆ—ä¸åŒï¼‰

**ç°æœ‰æ•°æ®ï¼ˆæ¥æº Aï¼‰**ï¼š
```
| URL | Date | Outlet | Headline | Nut Graph |
|-----|------|--------|----------|-----------|
| ... | ...  | ...    | ...      | ...       |
```

**æ–°æ•°æ®ï¼ˆæ¥æº Bï¼Œä»£ç ï¼‰**ï¼š
```
| Nested? | URL | Date | Outlet | Headline | Nut Graph |
|---------|-----|------|--------|----------|-----------|
| ...     | ... | ...  | ...    | ...      | ...       |
```

**ç»“æœ**ï¼šåˆ—åå’Œæ•°é‡ä¸åŒ¹é… â†’ éœ€è¦åˆ—å¯¹é½

### åœºæ™¯ 4: å†å²æ•°æ®ï¼ˆæ—§ç‰ˆæœ¬ï¼‰

**æƒ…å†µ**ï¼š
- Sheet ä¸­æœ‰å¾ˆä¹…ä»¥å‰çš„æ•°æ®ï¼ˆå¯èƒ½æ˜¯æ—§ç‰ˆæœ¬ä»£ç å†™å…¥çš„ï¼‰
- æ—§ç‰ˆæœ¬ä»£ç çš„åˆ—æ ¼å¼ä¸ç°åœ¨ä¸åŒ

**ç°æœ‰æ•°æ®ï¼ˆæ—§ç‰ˆæœ¬ï¼Œå¯èƒ½ï¼‰**ï¼š
```
| Headline | URL | Date | Outlet |
|----------|-----|------|--------|
| ...      | ... | ...  | ...    |
```

**æ–°æ•°æ®ï¼ˆå½“å‰ç‰ˆæœ¬ï¼‰**ï¼š
```
| Nested? | URL | Date | Outlet | Headline | Nut Graph |
|---------|-----|------|--------|----------|-----------|
| ...     | ... | ...  | ...    | ...      | ...       |
```

**ç»“æœ**ï¼š
- åˆ—åä¸åŒï¼ˆ"Headline" ä½ç½®ä¸åŒï¼‰
- åˆ—æ•°é‡ä¸åŒï¼ˆ4 åˆ— vs 6 åˆ—ï¼‰
- â†’ éœ€è¦åˆ—å¯¹é½

### åœºæ™¯ 5: ç©ºç™½ Sheet æˆ–æ ¼å¼é”™è¯¯

**æƒ…å†µ**ï¼š
- ç”¨æˆ·æ‰‹åŠ¨åˆ›å»ºäº†ä¸€ä¸ªç©ºç™½ sheet
- æˆ–è€… sheet çš„æ ‡é¢˜è¡Œæ ¼å¼ä¸æ­£ç¡®
- æˆ–è€…æ ‡é¢˜è¡Œè¢«æ„å¤–åˆ é™¤/ä¿®æ”¹

**ç°æœ‰æ•°æ®ï¼ˆæ ¼å¼é”™è¯¯ï¼‰**ï¼š
```
| æ ‡é¢˜ | é“¾æ¥ | æ—¥æœŸ | åª’ä½“ | æ‘˜è¦ |
|------|------|------|------|------|
| ...  | ...  | ...  | ...  | ...  |
```
ï¼ˆä¸­æ–‡åˆ—åï¼Œæˆ–è€…åˆ—åå®Œå…¨ä¸å¯¹ï¼‰

**æ–°æ•°æ®ï¼ˆä»£ç æ ¼å¼ï¼‰**ï¼š
```
| Nested? | URL | Date | Outlet | Headline | Nut Graph |
|---------|-----|------|--------|----------|-----------|
| ...     | ... | ...  | ...    | ...      | ...       |
```

**ç»“æœ**ï¼šåˆ—åå®Œå…¨ä¸åŒ¹é… â†’ éœ€è¦åˆ—å¯¹é½ï¼ˆä½†å¯èƒ½æ— æ³•æ­£ç¡®å¯¹é½ï¼‰

## ğŸ” å¦‚ä½•æ£€æµ‹åˆ—ä¸å¯¹é½ï¼Ÿ

ä»£ç ä¼šåœ¨ç¬¬ 200 è¡Œæ£€æŸ¥ï¼š
```python
if list(existing_df.columns) != expected_columns:
    print(f"âš ï¸ åˆ—åä¸åŒ¹é…ï¼ç°æœ‰åˆ—: {list(existing_df.columns)}, æœŸæœ›åˆ—: {expected_columns}")
```

**æ£€æŸ¥å†…å®¹**ï¼š
1. åˆ—åæ˜¯å¦å®Œå…¨ä¸€è‡´ï¼Ÿ
2. åˆ—é¡ºåºæ˜¯å¦å®Œå…¨ä¸€è‡´ï¼Ÿ
3. åˆ—æ•°é‡æ˜¯å¦ä¸€è‡´ï¼Ÿ

**å¦‚æœä»»ä½•ä¸€ä¸ªä¸åŒ¹é…**ï¼Œå°±ä¼šè§¦å‘åˆ—å¯¹é½ã€‚

## âœ… åˆ—å¯¹é½å¦‚ä½•å¤„ç†ï¼Ÿ

### æ­¥éª¤ 1: ä»¥æ–°æ•°æ®ä¸ºæ ‡å‡†
```python
expected_columns = df.columns.tolist()  # æ–°æ•°æ®çš„åˆ—åå’Œé¡ºåº
```

### æ­¥éª¤ 2: é‡æ–°æ’åˆ—ç°æœ‰æ•°æ®
```python
for col in expected_columns:
    if col in existing_df.columns:
        existing_df_aligned[col] = existing_df[col]  # ä¿ç•™ç°æœ‰æ•°æ®
    else:
        existing_df_aligned[col] = None  # ç¼ºå¤±çš„åˆ—å¡«å……ä¸º None
```

### æ­¥éª¤ 3: æ£€æŸ¥æ˜¯å¦ä¸¢å¤±æ•°æ®
```python
if len(existing_df) < before_alignment:
    raise ValueError("åˆ—å¯¹é½å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼åœæ­¢æ“ä½œï¼Œä¸æ¸…ç©º sheet")
```

## âš ï¸ åˆ—å¯¹é½å¯èƒ½å¯¼è‡´çš„é—®é¢˜

### é—®é¢˜ 1: æ•°æ®ä¸¢å¤±
- å¦‚æœç°æœ‰æ•°æ®çš„åˆ—åä¸æ–°æ•°æ®å®Œå…¨ä¸åŒ¹é…
- åˆ—å¯¹é½å¯èƒ½æ— æ³•æ­£ç¡®åŒ¹é…ï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±

### é—®é¢˜ 2: æ•°æ®é”™ä½
- å¦‚æœåˆ—åç›¸ä¼¼ä½†ä¸å®Œå…¨ä¸€è‡´ï¼ˆä¾‹å¦‚ "Headline" vs "æ ‡é¢˜"ï¼‰
- åˆ—å¯¹é½å¯èƒ½å°†æ•°æ®æ”¾åˆ°é”™è¯¯çš„åˆ—

### é—®é¢˜ 3: ç¼ºå¤±æ•°æ®
- å¦‚æœç°æœ‰æ•°æ®ç¼ºå°‘æŸäº›åˆ—ï¼ˆä¾‹å¦‚æ²¡æœ‰ "Nut Graph"ï¼‰
- è¿™äº›åˆ—ä¼šè¢«å¡«å……ä¸º `None`

## ğŸ’¡ å¦‚ä½•é¿å…åˆ—ä¸å¯¹é½ï¼Ÿ

### å»ºè®® 1: ä¸è¦æ‰‹åŠ¨ä¿®æ”¹åˆ—
- ä¸è¦åœ¨ Google Sheets ä¸­æ‰‹åŠ¨æ·»åŠ ã€åˆ é™¤æˆ–é‡å‘½ååˆ—
- å¦‚æœå¿…é¡»ä¿®æ”¹ï¼Œç¡®ä¿åˆ—åå’Œé¡ºåºä¸ä»£ç ä¸€è‡´

### å»ºè®® 2: ç»Ÿä¸€æ•°æ®æ¥æº
- å°½é‡ä½¿ç”¨åŒä¸€ä¸ªä»£ç è·¯å¾„å†™å…¥æ•°æ®
- é¿å…æ··åˆä½¿ç”¨ä¸åŒçš„å¯¼å‡ºæ–¹å¼

### å»ºè®® 3: ä»£ç æ›´æ–°æ—¶æ³¨æ„
- å¦‚æœæ›´æ–°äº†åˆ—æ ¼å¼ï¼Œè€ƒè™‘è¿ç§»ç°æœ‰æ•°æ®
- æˆ–è€…åˆ›å»ºæ–°çš„ sheetï¼Œé¿å…ä¸æ—§æ•°æ®æ··åˆ

### å»ºè®® 4: æ£€æŸ¥æ—¥å¿—
- å¦‚æœçœ‹åˆ° "âš ï¸ åˆ—åä¸åŒ¹é…" çš„è­¦å‘Šï¼Œæ£€æŸ¥ç°æœ‰æ•°æ®çš„åˆ—æ ¼å¼
- ç¡®ä¿åˆ—åå’Œé¡ºåºä¸ä»£ç ä¸€è‡´

## ğŸ“ æ€»ç»“

**åˆ—ä¸å¯¹é½é€šå¸¸å‘ç”Ÿåœ¨**ï¼š
1. âœ… ä»£ç æ›´æ–°ï¼ˆåˆ—æ ¼å¼æ”¹å˜ï¼‰
2. âœ… æ‰‹åŠ¨ä¿®æ”¹ Google Sheets
3. âœ… ä¸åŒä»£ç è·¯å¾„å†™å…¥
4. âœ… å†å²æ•°æ®ï¼ˆæ—§ç‰ˆæœ¬ï¼‰
5. âœ… æ ¼å¼é”™è¯¯ï¼ˆç©ºç™½ sheet æˆ–é”™è¯¯æ ‡é¢˜ï¼‰

**ä¿æŠ¤æªæ–½**ï¼š
- âœ… åˆ—å¯¹é½åæ£€æŸ¥è¡Œæ•°ï¼ˆç¡®ä¿æ²¡æœ‰ä¸¢å¤±æ•°æ®ï¼‰
- âœ… å¦‚æœæ£€æµ‹åˆ°æ•°æ®ä¸¢å¤±ï¼Œåœæ­¢æ“ä½œï¼Œä¸æ¸…ç©º sheet

**å»ºè®®**ï¼š
- âœ… ä¿æŒåˆ—æ ¼å¼ä¸€è‡´
- âœ… ä¸è¦æ‰‹åŠ¨ä¿®æ”¹åˆ—
- âœ… æ£€æŸ¥æ—¥å¿—ä¸­çš„è­¦å‘Šä¿¡æ¯

