# 🔥 热点榜功能说明

## 🎯 功能概述

热点榜会自动识别**被多家媒体报道的同一新闻**，并按类别分组显示。这样你可以快速发现重大新闻事件。

---

## ✨ 功能特点

### 1. 自动识别相似新闻

- 使用标题和内容相似度算法
- 识别同一事件的不同报道
- 默认相似度阈值：60%

### 2. 按类别分组

- 每个类别显示 **Top 3** 热点新闻
- 使用 **Tabs** 切换不同类别
- 按报道数量排序（最多媒体报道的在前面）

### 3. 显示详细信息

- **报道数量**: 有多少家媒体报道了这个新闻
- **报道媒体**: 具体是哪些媒体（如 NYT, SCMP, Reuters）
- **日期**: 新闻发布日期
- **相关链接**: 所有相关报道的链接（最多显示5个）

---

## 📊 使用方式

### 在网站上使用

1. **选择日期范围**（例如：最近一周）
2. **勾选** "从 Google Sheets 读取历史数据"（可选）
3. **选择来源**（建议选择所有来源，这样热点榜更准确）
4. **点击** "Generate & Export"
5. **查看热点榜**：
   - 在 "Summary" 下方
   - 显示 "🔥 热点榜"
   - 使用顶部的 **Tabs** 切换不同类别

### 示例

假设有 3 家媒体报道了同一个贸易协议新闻：

```
🔥 3 家媒体报道
US and China reach trade agreement
报道媒体: NYT, SCMP, Reuters
日期: 2025-11-03
相关报道:
- [查看原文](url1)
- [查看原文](url2)
- [查看原文](url3)
```

---

## 🔧 工作原理

### 1. 相似度检测

使用 `difflib.SequenceMatcher` 计算标题和内容的相似度：
- 清理文本（移除标点、转换为小写）
- 比较标题相似度
- 如果标题相似度不够，再比较标题+内容的组合

### 2. 分组

- 相似度 >= 60% 的文章被归为同一组
- 每组内的文章被视为同一事件的不同报道

### 3. 热点榜生成

- 只显示被 **至少 2 家媒体** 报道的新闻
- 每个类别显示 **Top 3**
- 按报道数量排序

---

## 📈 优化建议

### 增加更多来源

**越多来源，热点榜越准确！**

在 `config_en.yaml` 中添加更多 RSS 源：
- 更多新闻网站
- 不同语言来源
- 不同地区来源

### 调整相似度阈值

在 `app_with_sheets_db.py` 中修改：

```python
df_with_groups = group_similar_news(df.copy(), similarity_threshold=0.6)
```

- **降低阈值（如 0.5）**: 更宽松，可能把不完全相同的新闻归为一组
- **提高阈值（如 0.7）**: 更严格，只有非常相似的新闻才会归为一组

### 调整 Top N

修改每个类别显示的数量：

```python
trending_df = generate_trending_rank(df_with_groups, top_n=3)
```

改为 `top_n=5` 或 `top_n=10` 显示更多热点。

---

## 🎨 显示效果

### 多类别时

使用 **Tabs** 切换：
```
[Trade & Commerce] [Chips] [Geopolitics] [Administration] ...
```

### 单类别时

直接显示热点列表，无需切换。

---

## ⚠️ 注意事项

1. **需要至少 2 家媒体报道**同一新闻才会显示
2. **相似度检测**可能不完全准确（可能需要手动调整）
3. **数据越多**，热点榜越有价值（建议选择一周或更长时间）

---

## 🚀 未来优化

可能的改进方向：
- 使用机器学习模型提高相似度检测准确性
- 添加时间趋势分析（哪些新闻在上升/下降）
- 添加情感分析（正面/负面）
- 添加地理位置分析
- 导出热点榜到 Excel

---

## ✅ 完成！

现在你的网站已经有了动态热点榜功能！

**当你添加更多 RSS 源后，热点榜会自动变得更丰富、更准确！** 🎉

