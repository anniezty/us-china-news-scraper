# Streamlit Cloud Secrets 更新详细步骤

## 当前问题
配置显示 `deadline = "2025-11-17"`，需要更新为 `"2025-11-18 22:00"`（EST 5pm）或 `"2025-11-18 17:00"`（UTC 5pm）

## 详细步骤（带截图说明）

### 步骤 1: 登录并找到应用
1. 访问 https://share.streamlit.io/
2. 登录你的账户
3. 在应用列表中，找到你的应用（例如：`us-china-news-scraper`）

### 步骤 2: 进入应用设置
**方法 A（推荐）：**
- 点击应用名称进入应用详情页
- 点击右上角的 **"⋮"**（三个点）菜单
- 选择 **"Settings"**

**方法 B：**
- 直接点击应用旁边的 **"⋮"** 菜单
- 选择 **"Settings"**

### 步骤 3: 打开 Secrets 标签页
1. 在设置页面，点击 **"Secrets"** 标签页（在左侧导航栏或顶部标签栏）
2. 你会看到一个文本编辑器，显示当前的 Secrets 配置

### 步骤 4: 找到并更新 `[test_mode]` 部分
在 Secrets 编辑器中，找到：
```toml
[test_mode]
enabled = true
password = "test2025"
deadline = "2025-11-17"  # ← 这一行需要修改
```

**修改为：**
```toml
[test_mode]
enabled = true
password = "test2025"
deadline = "2025-11-18 22:00"  # ← 改为这个（EST 5pm = UTC 10pm）
```

或者如果你想要 UTC 时间：
```toml
deadline = "2025-11-18 17:00"  # UTC 5pm
```

### 步骤 5: 保存配置
1. 点击编辑器下方的 **"Save"** 按钮
2. 等待保存成功提示

### 步骤 6: 重新部署应用
**重要：** Secrets 更新后，应用不会自动重新部署，需要手动触发：

**方法 A：**
1. 在设置页面，点击 **"Reboot app"** 或 **"Restart app"** 按钮
2. 等待重新部署完成（通常 1-2 分钟）

**方法 B：**
1. 回到应用列表
2. 点击应用旁边的 **"⋮"** 菜单
3. 选择 **"Reboot"** 或 **"Restart"**

**方法 C（如果以上方法不可用）：**
1. 在 GitHub 上做一个小的提交（例如修改 README）
2. Streamlit Cloud 会自动检测并重新部署

### 步骤 7: 验证更新
1. 等待重新部署完成（查看部署状态）
2. 刷新应用页面（按 `Ctrl+Shift+R` 或 `Cmd+Shift+R` 强制刷新）
3. 如果更新成功，错误信息应该显示新的截止时间

## 常见问题排查

### 问题 1: 保存后没有变化
- **原因：** 应用没有重新部署
- **解决：** 手动触发重新部署（见步骤 6）

### 问题 2: 格式错误
- **错误示例：** `deadline = 2025-11-18 22:00`（缺少引号）
- **正确格式：** `deadline = "2025-11-18 22:00"`（必须有引号）

### 问题 3: 时间格式错误
- **错误示例：** `deadline = "2025-11-18 5:00 PM"`（12 小时制）
- **正确格式：** `deadline = "2025-11-18 22:00"`（24 小时制，UTC）

### 问题 4: 浏览器缓存
- **解决：** 按 `Ctrl+Shift+R`（Windows）或 `Cmd+Shift+R`（Mac）强制刷新

## 临时解决方案（如果需要立即访问）

如果更新 Secrets 后仍然无法访问，可以临时禁用测试模式：

在 Streamlit Cloud Secrets 中：
```toml
[test_mode]
enabled = false  # ← 临时禁用
password = "test2025"
deadline = "2025-11-18 22:00"
```

或者完全删除 `[test_mode]` 部分（不推荐，会失去密码保护）

## 验证配置是否正确

更新后，错误信息应该显示：
```
Configuration: deadline = "2025-11-18 22:00"
Parsed deadline: 2025-11-18 22:00 UTC
```

如果还是显示 `"2025-11-17"`，说明：
1. Secrets 没有正确保存
2. 应用没有重新部署
3. 浏览器缓存了旧页面

## 需要帮助？

如果按照以上步骤操作后仍然无法解决问题，请提供：
1. Streamlit Cloud Secrets 中 `[test_mode]` 部分的完整内容（隐藏密码）
2. 错误信息的完整内容
3. 是否已经重新部署应用

