# ç©ºç™½ Sheet å¯¼è‡´æ•°æ®ä¸¢å¤±çš„åˆ†æ

## ğŸ¤” ä½ çš„æƒ…å†µ

**ä½ è¯´**ï¼šåªæ˜¯æ–°å¢äº†ä¸€ä¸ªç©ºç™½ sheetï¼Œæ²¡æœ‰ä¿®æ”¹åˆ—

**é—®é¢˜**ï¼šä¸ºä»€ä¹ˆä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Ÿ

## ğŸ” ç©ºç™½ Sheet çš„å¤„ç†é€»è¾‘

ä»£ç åœ¨è¯»å–æ‰€æœ‰ sheet æ—¶ï¼ˆç¬¬ 148-173 è¡Œï¼‰ï¼Œä¼šè·³è¿‡ç©ºç™½ sheetï¼š

```python
for sheet in spreadsheet.worksheets():
    try:
        sheet_data = sheet.get_all_values()
        # è·³è¿‡ç©ºç™½ sheetï¼ˆåªæœ‰æ ‡é¢˜è¡Œæˆ–å®Œå…¨æ²¡æœ‰æ•°æ®ï¼‰
        if len(sheet_data) <= 1:
            continue  # âœ… å®Œå…¨ç©ºç™½çš„ sheet ä¼šè¢«è·³è¿‡
        # ç¡®ä¿æœ‰æ ‡é¢˜è¡Œä¸”è‡³å°‘æœ‰ä¸€è¡Œæ•°æ®
        if len(sheet_data[0]) == 0:
            continue  # âœ… æ²¡æœ‰æ ‡é¢˜è¡Œçš„ sheet ä¼šè¢«è·³è¿‡
        sheet_df = pd.DataFrame(sheet_data[1:], columns=sheet_data[0])
        # ç¡®ä¿æœ‰ URL åˆ—ä¸”æœ‰å®é™…æ•°æ®
        if 'URL' not in sheet_df.columns:
            continue  # âœ… æ²¡æœ‰ URL åˆ—çš„ sheet ä¼šè¢«è·³è¿‡
        urls = sheet_df['URL'].dropna()
        # å¦‚æœæ²¡æœ‰ä»»ä½• URLï¼Œè·³è¿‡ï¼ˆå¯èƒ½æ˜¯ç©ºç™½ sheetï¼‰
        if len(urls) == 0:
            continue  # âœ… æ²¡æœ‰ URL æ•°æ®çš„ sheet ä¼šè¢«è·³è¿‡
    except Exception as e:
        print(f"âš ï¸ è¯»å– sheet '{sheet.title}' æ—¶å‡ºé”™: {e}")
        continue  # âœ… å‡ºé”™çš„ sheet ä¼šè¢«è·³è¿‡
```

## âš ï¸ ç©ºç™½ Sheet å¯èƒ½å¯¼è‡´çš„é—®é¢˜

### é—®é¢˜ 1: ç©ºç™½ Sheet æœ‰é»˜è®¤æ ‡é¢˜è¡Œ

**æƒ…å†µ**ï¼š
- Google Sheets åˆ›å»ºæ–° sheet æ—¶ï¼Œå¯èƒ½è‡ªåŠ¨ç”Ÿæˆé»˜è®¤æ ‡é¢˜è¡Œï¼ˆA, B, C, D...ï¼‰
- æˆ–è€…ç”¨æˆ·æ‰‹åŠ¨æ·»åŠ äº†æ ‡é¢˜è¡Œï¼Œä½†åˆ—åä¸å¯¹

**ç°æœ‰æ•°æ®ï¼ˆæ­£å¸¸ sheetï¼‰**ï¼š
```
| Nested? | URL | Date | Outlet | Headline | Nut Graph |
|---------|-----|------|--------|----------|-----------|
| ...     | ... | ...  | ...    | ...      | ...       |
```

**ç©ºç™½ sheetï¼ˆæœ‰é»˜è®¤æ ‡é¢˜è¡Œï¼‰**ï¼š
```
| A | B | C | D | E | F |
|---|---|---|---|---|---|
|   |   |   |   |   |   |
```

**ç»“æœ**ï¼š
- ç©ºç™½ sheet ä¼šè¢«è·³è¿‡ï¼ˆå› ä¸ºæ²¡æœ‰ URL åˆ—ï¼‰
- **ä¸åº”è¯¥å¯¼è‡´é—®é¢˜**

### é—®é¢˜ 2: ç©ºç™½ Sheet çš„æ ‡é¢˜è¡Œæ ¼å¼ä¸å¯¹

**æƒ…å†µ**ï¼š
- ç©ºç™½ sheet çš„æ ‡é¢˜è¡Œå¯èƒ½æ˜¯ï¼š`["URL", "Date", "Headline"]`ï¼ˆåªæœ‰éƒ¨åˆ†åˆ—ï¼‰
- æˆ–è€…ï¼š`["æ ‡é¢˜", "é“¾æ¥", "æ—¥æœŸ"]`ï¼ˆä¸­æ–‡åˆ—åï¼‰

**ç»“æœ**ï¼š
- å¦‚æœè¿™ä¸ª sheet è¢«è¯¯è®¤ä¸ºæ˜¯å½“å‰ sheetï¼Œå¯èƒ½å¯¼è‡´åˆ—å¯¹é½é—®é¢˜
- ä½†ä»£ç ä¼šæ£€æŸ¥ `'URL' not in sheet_df.columns`ï¼Œåº”è¯¥ä¼šè¢«è·³è¿‡

### é—®é¢˜ 3: ç©ºç™½ Sheet å¯¼è‡´è¯»å–é”™è¯¯

**æƒ…å†µ**ï¼š
- ç©ºç™½ sheet çš„æ ¼å¼æœ‰é—®é¢˜ï¼Œå¯¼è‡´ `sheet.get_all_values()` è¿”å›å¼‚å¸¸æ•°æ®
- æˆ–è€…è¯»å–æ—¶å‡ºé”™ï¼Œä½†é”™è¯¯è¢«æ•è·

**ç»“æœ**ï¼š
- é”™è¯¯ä¼šè¢«æ•è·ï¼ˆç¬¬ 171-173 è¡Œï¼‰ï¼Œsheet ä¼šè¢«è·³è¿‡
- **ä¸åº”è¯¥å¯¼è‡´æ•°æ®ä¸¢å¤±**

## ğŸ” çœŸæ­£çš„é—®é¢˜å¯èƒ½åœ¨å“ªé‡Œï¼Ÿ

### å¯èƒ½çš„é—®é¢˜ 1: ç©ºç™½ Sheet è¢«è¯¯è®¤ä¸ºæ˜¯å½“å‰ Sheet

**å¦‚æœç©ºç™½ sheet çš„åç§°ä¸ç›®æ ‡ sheet ç›¸åŒ**ï¼š
- ä»£ç å¯èƒ½ä¼šè¯»å–ç©ºç™½ sheet ä½œä¸º `existing_data`
- å¦‚æœç©ºç™½ sheet æœ‰æ ‡é¢˜è¡Œä½†åˆ—åä¸å¯¹ï¼Œå¯èƒ½å¯¼è‡´åˆ—å¯¹é½é—®é¢˜

**æ£€æŸ¥**ï¼šç©ºç™½ sheet çš„åç§°æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å¦ä¸ç›®æ ‡ sheet åç§°ç›¸åŒï¼Ÿ

### å¯èƒ½çš„é—®é¢˜ 2: è¯»å–æ‰€æœ‰ Sheet æ—¶å‡ºé”™

**å¦‚æœè¯»å–æ‰€æœ‰ sheet æ—¶å‡ºé”™**ï¼š
- å¯èƒ½å¯¼è‡´ `all_existing_urls` æˆ– `current_sheet_urls` ä¸æ­£ç¡®
- ä½†è¿™ä¸åº”è¯¥å½±å“å½“å‰ sheet çš„æ•°æ®è¯»å–

### å¯èƒ½çš„é—®é¢˜ 3: åˆ—å¯¹é½æ—¶çš„è¾¹ç•Œæƒ…å†µ

**å¦‚æœç©ºç™½ sheet çš„æ ‡é¢˜è¡Œæ ¼å¼ç‰¹æ®Š**ï¼š
- å¯èƒ½å¯¼è‡´åˆ—å¯¹é½é€»è¾‘å‡ºé”™
- ä½†ä»£ç æœ‰ä¿æŠ¤æªæ–½ï¼Œåº”è¯¥ä¼šæ£€æµ‹åˆ°

## ğŸ’¡ ä¸ºä»€ä¹ˆç©ºç™½ Sheet ä¸åº”è¯¥å¯¼è‡´é—®é¢˜ï¼Ÿ

### ä¿æŠ¤æªæ–½ 1: å¤šå±‚è·³è¿‡æ£€æŸ¥
- âœ… å®Œå…¨ç©ºç™½ â†’ è·³è¿‡
- âœ… æ²¡æœ‰æ ‡é¢˜è¡Œ â†’ è·³è¿‡
- âœ… æ²¡æœ‰ URL åˆ— â†’ è·³è¿‡
- âœ… æ²¡æœ‰ URL æ•°æ® â†’ è·³è¿‡

### ä¿æŠ¤æªæ–½ 2: é”™è¯¯æ•è·
- âœ… è¯»å–å‡ºé”™ â†’ æ•è·å¼‚å¸¸ï¼Œè·³è¿‡è¯¥ sheet

### ä¿æŠ¤æªæ–½ 3: åˆ—å¯¹é½æ£€æŸ¥
- âœ… å¦‚æœåˆ—å¯¹é½å¯¼è‡´æ•°æ®ä¸¢å¤± â†’ åœæ­¢æ“ä½œï¼Œä¸æ¸…ç©º sheet

## ğŸ¤” é‚£ä¹ˆæ•°æ®ä¸¢å¤±çš„çœŸæ­£åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ

### å¯èƒ½çš„åŸå›  1: ä¹‹å‰çš„ä»£ç æ²¡æœ‰ä¿æŠ¤æªæ–½

**å¦‚æœæ•°æ®ä¸¢å¤±å‘ç”Ÿåœ¨æ·»åŠ ä¿æŠ¤æªæ–½ä¹‹å‰**ï¼š
- ä¹‹å‰çš„ä»£ç å¯èƒ½æ²¡æœ‰è¿™äº›æ£€æŸ¥
- ç©ºç™½ sheet å¯èƒ½è§¦å‘äº†æŸä¸ªè¾¹ç•Œæƒ…å†µï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±

### å¯èƒ½çš„åŸå›  2: ç©ºç™½ Sheet çš„æ ¼å¼ç‰¹æ®Š

**å¦‚æœç©ºç™½ sheet æœ‰ç‰¹æ®Šçš„æ ¼å¼**ï¼š
- ä¾‹å¦‚ï¼šæœ‰éšè—çš„æ ¼å¼åŒ–å•å…ƒæ ¼
- æˆ–è€…ï¼šæ ‡é¢˜è¡Œæ ¼å¼ä¸å¯¹ï¼Œä½†é€šè¿‡äº†æŸäº›æ£€æŸ¥
- å¯èƒ½å¯¼è‡´åˆ—å¯¹é½å‡ºé”™

### å¯èƒ½çš„åŸå›  3: å…¶ä»–å› ç´ 

**å¯èƒ½ä¸æ˜¯ç©ºç™½ sheet å¯¼è‡´çš„**ï¼š
- å¯èƒ½æ˜¯ä»£ç æ›´æ–°å¯¼è‡´çš„åˆ—æ ¼å¼å˜åŒ–
- æˆ–è€…ï¼šå…¶ä»–æ“ä½œå¯¼è‡´çš„æ•°æ®ä¸¢å¤±

## âœ… ç°åœ¨çš„ä¿æŠ¤æªæ–½

**æ— è®ºç©ºç™½ sheet æ˜¯å¦å­˜åœ¨ï¼Œç°åœ¨çš„ä»£ç éƒ½æœ‰ä¿æŠ¤æªæ–½**ï¼š

1. âœ… ç©ºç™½ sheet ä¼šè¢«è·³è¿‡
2. âœ… å¦‚æœåˆ—å¯¹é½å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œä¼šåœæ­¢æ“ä½œ
3. âœ… å¦‚æœåˆå¹¶å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œä¼šåœæ­¢æ“ä½œ

**ç»“è®º**ï¼šç°åœ¨åº”è¯¥ä¸ä¼šå†å› ä¸ºç©ºç™½ sheet å¯¼è‡´æ•°æ®ä¸¢å¤±äº†ã€‚

## ğŸ“ å»ºè®®

1. **åˆ é™¤ç©ºç™½ sheet**ï¼šå¦‚æœä¸éœ€è¦ï¼Œå¯ä»¥åˆ é™¤ç©ºç™½ sheet
2. **æ£€æŸ¥æ—¥å¿—**ï¼šæŸ¥çœ‹æ˜¯å¦æœ‰ "âš ï¸ è¯»å– sheet" æˆ– "âŒ é”™è¯¯" ä¿¡æ¯
3. **ç›‘æ§æ•°æ®é‡**ï¼šå¦‚æœå†æ¬¡é‡åˆ°æ•°æ®ä¸¢å¤±ï¼Œæ£€æŸ¥æ—¥å¿—ä¸­çš„è¯¦ç»†ä¿¡æ¯

